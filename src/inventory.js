var RocketTux = RocketTux || {};
 
RocketTux.Inventory = function(){};
 
RocketTux.Inventory.prototype = {
	init: function(){
		// console.log("Inventory state loaded");
	},
	preload: function() {
		
	},
	create: function() {
		// Background image
		this.bgImage = this.game.add.sprite(0, 0, 'skies-special');
		this.bgImage.animations.add('stand', [3], 1, true);
		this.bgImage.scale.setTo(1.25, 0.71); //wide, tall
		this.bgImage.width = this.game.width;
		this.bgImage.play('stand');
		this.bgImage.fixedToCamera = true;
			
		// Load menu tilemaps and draw game device
		this.makeMenu();
		
		this.style = { 
			font: "11px Verdana", 
			fill: "#ffffff", align: "left"
		};
		this.escText = this.game.add.text(4, 2, "Press ESC to exit", this.style);
		
		this.titleStyle = { 
			font: "30px Verdana", 
			fill: "#01BB01", 
			boundsAlignH: "center", boundsAlignV: "top"
		};
		this.titleText = this.game.add.text(0, 0, "Inventory", this.titleStyle);
		this.titleText.setTextBounds(160, 94, 672, 32);
		
		this.colStyle = { 
			font: "22px Verdana", 
			fill: "#01BB01", 
			boundsAlignH: "left", boundsAlignV: "top"
		};
		this.haveText = this.game.add.text(190, 102, "Have", this.colStyle);
		this.sellText = this.game.add.text(750, 102, "Sell", this.colStyle);
		
		this.pagerStyle = { 
			font: "26px Verdana", 
			fill: "#01BB01", 
			boundsAlignH: "center", boundsAlignV: "middle"
		};
		this.pagerText = this.game.add.text(0, 0, "1 / 25", this.pagerStyle);
		this.pagerText.setTextBounds(960, 608, 160, 64);
		
		// Item quantities
		this.haveQ = {};
		this.sellQ = {};
		var i = 0;
		
		for (i = 0; i < 8; i++){
			this.haveQ[i] = this.game.add.text(190, 150 + i*64, "0", this.colStyle);
			this.sellQ[i] = this.game.add.text(750, 150+ i*64, "0", this.colStyle);
		}
		
		// Item icons
		this.showPage = 1;
		this.itemIcons = this.game.add.group();
		var tmpIcon;
		

		for (i = 0; i < 8; i++){
			tmpIcon = this.itemIcons.create(288, 150 + i*64, 'atlas');
			tmpIcon.frameName = 'icon-' + i;
			tmpIcon.fixedToCamera = true;
		}
		
		// Item descriptions and hints
		this.descStyle = { 
			font: "15px Verdana", 
			fill: "#01BB01", 
			boundsAlignH: "left", boundsAlignV: "top"
		};
		this.desc = {};
		var i = 0;
		
		for (i = 0; i < 8; i++){
			this.desc[i] = this.game.add.text(334, 142 + i*64, "", this.descStyle);
			this.desc[i].text = RocketTux.lootNames[i] + "\nHint: " + RocketTux.lootDesc[i];
		}
	}, 
	update: function() {
		if (this.game.input.keyboard.downDuration(Phaser.Keyboard.ESC, 1)){
			this.game.state.start('MainMenu');
		}
	},
	shutdown: function(){
		// console.log("Inventory state exited");
	},
	makeMenu: function (){
	// Tilemap data
	this.layers = {
		// Background texture that can be colorized
		bg:[
			'0,0,0,150,151,151,151,151,151,151,151,151,151,151,151,151,151,151,151,151,151,151,151,151,151,151,151,151,151,151,151,151,151,151,151,151,152,0,0,0,',
			'0,0,0,166,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,168,0,0,0,',
			'0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,',
			'0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,',
			'0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,',
			'0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,',
			'0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,',
			'0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,',
			'0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,',
			'0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,',
			'0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,',
			'0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,',
			'0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,',
			'0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,9,1,1,1,1,1,1,0,0,0,',
			'0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,',
			'0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,',
			'0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,',
			'0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,',
			'0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,',
			'0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,',
			'0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,',
			'0,0,0,118,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,120,0,0,0,',
			'0,0,0,134,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,135,136,0,0,0,'
		],
		// Foreground parts (frame, buttons, etc)
		fg:[
			'0,0,0,77,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,79,0,0,0,',
			'0,0,0,93,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,95,0,0,0,',
			'0,0,0,92,70,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,72,0,0,0,0,0,0,0,0,0,76,0,0,0,',
			'0,0,0,92,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,0,0,0,0,0,0,0,0,0,76,0,0,0,',
			'0,0,0,92,86,69,102,102,104,102,102,102,102,102,102,102,102,102,102,102,102,102,104,102,102,85,86,0,0,0,0,2,3,4,0,0,76,0,0,0,',
			'0,0,0,92,86,86,86,86,103,86,86,86,86,86,86,86,86,86,86,86,86,86,103,86,86,86,86,0,0,16,17,18,19,20,21,0,76,0,0,0,',
			'0,0,0,92,86,69,102,102,101,102,102,102,102,102,102,102,102,102,102,102,102,102,101,102,102,85,86,0,0,32,33,34,35,36,37,0,76,0,0,0,',
			'0,0,0,92,86,86,86,86,103,86,86,86,86,86,86,86,86,86,86,86,86,86,103,86,86,86,86,0,0,48,49,50,51,52,53,0,76,0,0,0,',
			'0,0,0,92,86,69,102,102,101,102,102,102,102,102,102,102,102,102,102,102,102,102,101,102,102,85,86,0,0,0,0,66,67,0,0,0,76,0,0,0,',
			'0,0,0,92,86,86,86,86,103,86,86,86,86,86,86,86,86,86,86,86,86,86,103,86,86,86,86,0,0,0,0,82,83,0,0,0,76,0,0,0,',
			'0,0,0,92,86,69,102,102,101,102,102,102,102,102,102,102,102,102,102,102,102,102,101,102,102,85,86,0,0,0,0,0,0,6,7,8,76,0,0,0,',
			'0,0,0,92,86,86,86,86,103,86,86,86,86,86,86,86,86,86,86,86,86,86,103,86,86,86,86,0,0,0,0,0,0,22,10,24,76,0,0,0,',
			'0,0,0,92,86,69,102,102,101,102,102,102,102,102,102,102,102,102,102,102,102,102,101,102,102,85,86,0,0,6,7,8,0,38,39,40,76,0,0,0,',
			'0,0,0,92,86,86,86,86,103,86,86,86,86,86,86,86,86,86,86,86,86,86,103,86,86,86,86,0,0,22,9,24,0,0,0,0,76,0,0,0,',
			'0,0,0,92,86,69,102,102,101,102,102,102,102,102,102,102,102,102,102,102,102,102,101,102,102,85,86,0,0,38,39,40,0,0,0,0,76,0,0,0,',
			'0,0,0,92,86,86,86,86,103,86,86,86,86,86,86,86,86,86,86,86,86,86,103,86,86,86,86,0,0,0,0,0,0,0,0,0,76,0,0,0,',
			'0,0,0,92,86,69,102,102,101,102,102,102,102,102,102,102,102,102,102,102,102,102,101,102,102,85,86,0,0,0,0,0,0,0,0,0,76,0,0,0,',
			'0,0,0,92,86,86,86,86,103,86,86,86,86,86,86,86,86,86,86,86,86,86,103,86,86,86,86,0,0,11,45,15,0,11,44,15,76,0,0,0,',
			'0,0,0,92,86,69,102,102,101,102,102,102,102,102,102,102,102,102,102,102,102,102,101,102,102,85,86,0,0,27,28,31,0,27,28,31,76,0,0,0,',
			'0,0,0,92,86,86,86,86,103,86,86,86,86,86,86,86,86,86,86,86,86,86,103,86,86,86,86,0,0,0,70,71,71,71,72,0,76,0,0,0,',
			'0,0,0,92,87,69,102,102,105,102,102,102,102,102,102,102,102,102,102,102,102,102,105,102,102,85,88,0,0,0,87,86,86,86,88,0,76,0,0,0,',
			'0,0,0,73,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,75,0,0,0,',
			'0,0,0,89,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,91,0,0,0,'
		]
	};
	
	// Background texture
	var data = '';
	var tmpRow = "";
	
	for (i = 0; i < 23; i++){
		tmpRow = this.layers.bg[i].toString();
		data += tmpRow.slice(0, -1) + "\n";
	}
	
	this.game.cache.addTilemap('dynamicMap', null, data, Phaser.Tilemap.CSV);
	this.menuMapBG = this.game.add.tilemap('dynamicMap', 32, 32);
	this.menuMapBG.addTilesetImage('menu-map', 'menu-map', 32, 32);
	this.menuBG = this.menuMapBG.createLayer(0);
	this.menuBG.resizeWorld();
	this.menuBG.tint = RocketTux.mainMenuColor;
	
	// Foreground items
	data = '';
	tmpRow = "";
	
	for (i = 0; i < 23; i++){
		tmpRow = this.layers.fg[i].toString();
		data += tmpRow.slice(0, -1) + "\n";
	}
	
	this.game.cache.addTilemap('dynamicMap', null, data, Phaser.Tilemap.CSV);
	this.menuMapFG = this.game.add.tilemap('dynamicMap', 32, 32);
	this.menuMapFG.addTilesetImage('menu-map', 'menu-map', 32, 32);
	this.menuFG = this.menuMapFG.createLayer(0);
	this.menuFG.resizeWorld();
  },
};
